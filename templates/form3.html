<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="static/style.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap" rel="stylesheet">
    <title>NO LOVE NO LIFE</title>
</head>
<body>
    <header> 
        <h1>NO LOVE NO LIFE</h1>
    </header>

    <main class="main2">
        <div class="b">
            <h2>Popuni formu i pronadji svoju srodnu dusu!</h2>
            <h3>XOXOXOXO</h3>
        </div>
        
        <!-- Lista koja se popunjava podacima -->
        <ul id="userList"></ul> 
        <table id="dataTable" class = "Table2">
            <thead class = "th1">
                <tr>
                    <th>Par 1</th>
                    <th>Par 2</th>
                </tr>
            </thead>
            <tbody class = "td1">
                <!-- Podaci će biti dodani ovde pomoću JavaScript-a -->
            </tbody>
        </table>
      <script>
  <script>
  window.onload = function() {
    // Učitaj podatke iz baze putem JSON rute
    fetch('/get_form3_data')  // Ruta koja vraća JSON podatke
        .then(response => {
            console.log("Response: ", response);  // Logovanje odgovora
            if (!response.ok) {
                throw new Error("Ne mogu da dohvatim podatke");
            }
            return response.json();  // Pretvori JSON odgovor u objekat
        })
        .then(data => {
            console.log("Data: ", data);  // Logovanje podataka
            const userList = data.lista;  // 'lista' je ključ koji sadrži podatke
            const userListElement = document.getElementById('userList');

            // Provera da li ima korisnika
            if (userList && userList.length > 0) {
                // Prikazivanje podataka u tabeli
                let tableBody = document.getElementById("dataTable").getElementsByTagName("tbody")[0];
                tableBody.innerHTML = '';  // Očisti prethodne redove

                userList.forEach(user => {
                    // Ako je korisnik zauzet, prikaži ga u tabeli
                    if (user.zauzet) {
                        // Kreiraj novi red za tabelu
                        let row = document.createElement("tr");

                        // Kreiraj ćeliju za ID korisnika
                        let cell1 = document.createElement("td");
                        cell1.textContent = user.id;
                        row.appendChild(cell1);

                        // Kreiraj ćeliju za ID para korisnika
                        let cell2 = document.createElement("td");
                        cell2.textContent = user.par || 'Nema para';
                        row.appendChild(cell2);

                        // Dodajte red u telo tabele
                        tableBody.appendChild(row);
                    }
                });
            } else {
                const noDataMessage = document.createElement('li');
                noDataMessage.textContent = 'Nema podataka za prikazivanje.';
                userListElement.appendChild(noDataMessage);
            }
        })
        .catch(error => {
            console.error("Greška pri učitavanju podataka:", error);  // Logovanje greške
        });
  }
</script>

        </script>

    </main>

    <footer >
        <p class="a"> Napravljeno s ljubavlju za NLNL &#169; 2025 </p>
    </footer>
</body>
</html>
